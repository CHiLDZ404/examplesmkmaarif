<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>PPDB - SMK MA'ARIF NU BANJARSARI</title>
<link rel="stylesheet" href="style.css">
<link rel="icon" href="favicon.ico">
</head>
<body>
<div class="container">
<header>
  <div class="header-inner">
    <div class="brand"><div class="logo">SMK</div><div><strong>PPDB SMK MA'ARIF NU</strong><div class="small muted">Pendaftaran Siswa Baru</div></div></div>
    <nav class="desktop"><a href="index.html">Beranda</a><a href="ppdb.html">PPDB</a><a href="gallery.html">Galeri</a><a href="admin.html">Admin</a></nav>
  </div>
</header>

<section class="card">
  <h2>Formulir PPDB</h2>
  <form id="ppdbForm" enctype="multipart/form-data" aria-live="polite">
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px">
      <input id="nama" type="text" placeholder="Nama Lengkap" required>
      <input id="nisn" type="text" placeholder="NISN">
      <input id="birth" type="date" placeholder="Tanggal Lahir">
      <input id="phone" type="text" placeholder="Telepon / WA">
    </div>
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:10px">
      <input id="email" type="email" placeholder="Email" required>
      <select id="jurusan" required>
        <option value="">Pilih Jurusan</option>
        <option value="TKJ">Teknik Komputer & Jaringan</option>
        <option value="AP">Administrasi Perkantoran</option>
      </select>
    </div>

    <label style="margin-top:10px">Unggah Dokumen (PDF / JPG / PNG) — maksimal 5 file</label>
    <input id="dokumen" type="file" accept=".pdf,.jpg,.jpeg,.png" multiple>

    <div class="actions">
      <div id="ppdbStatus" class="small muted" aria-live="polite"></div>
      <div style="display:flex;gap:8px">
        <button type="reset" class="btn ghost">Reset</button>
        <button type="submit" class="btn">Kirim Pendaftaran</button>
      </div>
    </div>
  </form>
</section>

<footer class="small muted">© <span id="year"></span> SMK MA'ARIF NU BANJARSARI</footer>
</div>

<script src="script.js"></script>
<script>
document.getElementById('year').textContent = new Date().getFullYear();
// PPDB form handling - uses shared DB
const ppdbForm = document.getElementById('ppdbForm');
const ppdbStatus = document.getElementById('ppdbStatus');
ppdbForm.addEventListener('submit', async function(e){
  e.preventDefault();
  ppdbStatus.textContent = '';
  const nama = document.getElementById('nama').value.trim();
  const email = document.getElementById('email').value.trim();
  const jurusan = document.getElementById('jurusan').value;
  const files = document.getElementById('dokumen').files;
  if(!nama || !email || !jurusan){ ppdbStatus.textContent = 'Lengkapi nama, email, dan jurusan.'; return; }
  if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)){ ppdbStatus.textContent='Email tidak valid.'; return; }
  try{
    const appId = await DB.addApp({nama,email,jurusan,createdAt:new Date().toISOString()});
    const max = Math.min(files.length,5);
    for(let i=0;i<max;i++){ const f=files[i]; await DB.addFile({applicationId:appId,name:f.name,type:f.type,size:f.size,blob:f}); }
    ppdbStatus.style.color='var(--success)'; ppdbStatus.textContent = 'Pendaftaran berhasil. Terima kasih!'; ppdbForm.reset(); 
  }catch(err){ ppdbStatus.textContent = 'Gagal: '+err; }
});
</script>
</body>
</html>